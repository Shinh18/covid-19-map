(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{"sg+I":function(e,t,n){},tjUo:function(e,t,n){"use strict";n.r(t);n("sg+I"),n("QWBl"),n("pjDv"),n("4mDm"),n("2B1R"),n("ToJy"),n("sMBO"),n("Tskq"),n("07d7"),n("PKPk"),n("wgYD"),n("R3/m"),n("l/vG"),n("0q/z"),n("n5pg"),n("Q7Pz"),n("Vnov"),n("nIe3"),n("CUyW"),n("qc1c"),n("VOz1"),n("Thag"),n("9D6x"),n("FZtP"),n("3bBZ");var o=n("lwsE"),i=n.n(o),a=n("W8MJ"),r=n.n(a),s=n("lSNA"),c=n.n(s),l=n("nbsC"),p=n.n(l),u=(n("zKZe"),Object.assign({},n("4R65"),n("JXP8"))),d=new u.Icon({iconUrl:"./assets/mapIcons/rent-strike.svg",iconSize:[40,40],iconAnchor:[20,20],className:"icon-rent-strike"}),m=u,f=n("xo8x").a.apply(void 0,["fetch-map-data-resolve","fetch-map-data-reject","viewport-size","render-infowindow","close-infowindow","title-details-toggle","title-details-close","title-details-open","show-loading-indicator","hide-loading-indicator"]),y=(n("tkto"),n("pNMO"),n("ma9I"),n("TeQF"),n("5DmW"),n("27RR"),"public.emergency_tenant_protections_scored");function h(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function g(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?h(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var w={cities:{name:"City Protections",type:"point",query:"\nSELECT\n  municipality, state, country, range,\n  policy_type, policy_summary, link, the_geom\nFROM ".concat(y,"\nWHERE the_geom is not null and admin_scale = 'City'\nORDER BY range"),zIndex:1,props:function(e){var t=e.feature.properties,n=t.municipality,o=t.state,i=t.country;return g(g({},e.feature.properties),{},{jurisdictionName:"".concat(n).concat(o?", ".concat(o):"").concat(i?", ".concat(i):""),jurisdictionType:"City",popupName:n,policyStrength:O[e.feature.properties.range]})},style:function(e){return{color:L[e.properties.range]||v,fillColor:b[e.properties.range]||v,fillOpacity:T,radius:E,weight:k}},pointToLayer:function(e,t){return m.circleMarker(t,w.cities.style(e))}},counties:{name:"County Protections",type:"polygon",query:"\nSELECT\n  c.the_geom, c.county, c.state, m.range,\n  m.policy_type, m.policy_summary, m.link, m.range\nFROM ".concat("public.us_county_boundaries"," c\nJOIN ").concat(y," m\nON ST_Intersects(c.the_geom, m.the_geom)\nWHERE m.the_geom IS NOT NULL\n  AND m.admin_scale = 'County'\n  OR m.admin_scale = 'City and County'\nORDER BY m.range"),zIndex:2,props:function(e){var t=e.feature.properties,n=t.state,o=t.county;return g(g({},e.feature.properties),{},{jurisdictionName:"".concat(o).concat(n?", ".concat(n):""),jurisdictionType:"County",popupName:"".concat(o).concat(n?", ".concat(n):""),policyStrength:O[e.feature.properties.range]})},style:function(e){return{color:L[e.properties.range]||v,fillColor:b[e.properties.range]||v,fillOpacity:T,weight:k}}},states:{name:"State/Province Protections",type:"polygon",query:"\nSELECT\n  s.the_geom, s.name, s.admin, s.sr_adm0_a3,\n  m.range, m.iso, m .policy_type, m.policy_summary, m.link\nFROM ".concat("public.states_and_provinces_global"," s\nINNER JOIN ").concat(y," m\n  ON s.name = m.state\n  AND s.sr_adm0_a3 = m.iso\n  AND m.admin_scale = 'State'\nORDER BY m.range"),zIndex:3,props:function(e){var t=e.feature.properties,n=t.name,o=t.admin;return g(g(g({},e.feature.properties),e.feature.properties),{},{jurisdictionName:"".concat(n).concat(o?", ".concat(o):""),jurisdictionType:"State/Province",popupName:n,policyStrength:O[e.feature.properties.range]})},style:function(e){return{color:L[e.properties.range]||v,fillColor:b[e.properties.range]||v,fillOpacity:T,weight:k}}},nations:{name:"National Protections",type:"polygon",query:"\nSELECT\n  c.the_geom, c.adm0_a3, c.name_en, m.range,\n  m.policy_type, m.policy_summary, m.link\nFROM ".concat("public.countries"," c\nINNER JOIN ").concat(y," m\n  ON c.adm0_a3 = m.iso\n  AND m.admin_scale = 'Country'\nORDER BY m.range"),zIndex:4,props:function(e){var t=e.feature.properties.name_en;return g(g({},e.feature.properties),{},{jurisdictionName:t,jurisdictionType:"Country",popupName:t,policyStrength:O[e.feature.properties.range]})},style:function(e){return{color:L[e.properties.range]||v,fillColor:b[e.properties.range]||v,fillOpacity:T,weight:k}}},rentStrikes:{name:"Housing Justice Actions",type:"marker-cluster",query:"\n  SELECT\n    CASE\n      WHEN strike_status IN ('Yes / Sí / 是 / Oui', 'Yes') THEN 'Yes'\n      WHEN strike_status IN ('Unsure / No estoy segurx / 不确定 / Pas sûr.e.s.', 'No') THEN 'No'\n      ELSE 'Unsure'\n    END AS status,\n    TO_CHAR(start :: DATE, 'Month d, yyyy') as start,\n    the_geom, location, why, resources\n  FROM ".concat("public.emergency_housing_actions","\n  WHERE the_geom IS NOT NULL;\n"),zIndex:0,props:function(e){return e.feature.properties},pointToLayer:function(e,t){return m.marker(t,{icon:d})}}};window.mapLayersConfig=w;var v="#939393",b=[void 0,"#d9f0a3","#78c679","#238443"],L=[void 0,"#addd8e","#41ab5d","#005a32"],k=1.5,E=8,T=.7,O=["","Few protections in place","Some protections in place","Many protections in place"],_={lat:40.67,lng:-97.23,z:4,nations:!1,states:!0,cities:!0,counties:!0,rentStrikes:!0},C=Object.keys(w).length,I=function(){return document.querySelector("body").offsetWidth<640},N=function(){function e(t){var n=this;i()(this,e),c()(this,"dataLayers",new Map),c()(this,"popupTemplate",document.querySelector(".popup-template").innerHTML),c()(this,"rentStrikePopupTemplate",document.querySelector(".rentstrike-popup-template").innerHTML),c()(this,"handleWindowResize",(function(){I()&&n.map.invalidateSize()})),c()(this,"handleInfoWindowClose",(function(){n.map.closePopup(),I()&&n.map.invalidateSize()})),c()(this,"handleAddLayerError",(function(e){console.error(e),n.toggleLoadingIndicator(!1)})),c()(this,"handleAddLayer",(function(e){var t,o,i,a=e.key,r=e.layerConfig,s=e.data,c=n;switch(r.type){case"point":t=m.geoJson(s,{pointToLayer:r.pointToLayer});break;case"polygon":t=m.geoJson(s,{style:function(e){return r.style(e)}});break;case"marker-cluster":o=m.geoJson(s,{pointToLayer:r.pointToLayer}),(i=m.markerClusterGroup({maxClusterRadius:40}).on("clusterclick",(function(){I()&&f.call("title-details-close")}))).addLayer(o).bindPopup((function(e){return f.call("render-infowindow",null,{template:"rentstrikes",data:e.feature.properties}),p.a.render(c.rentStrikePopupTemplate,r.props(e))})),t=i;break;default:throw Error("Unrecognized map layer type")}"marker-cluster"!==r.type&&t.bindPopup((function(e){var t=r.props(e);return f.call("render-infowindow",null,{template:"protections",data:t}),p.a.render(c.popupTemplate,t)})),n.dataLayers.set(r.name,{layerGroup:t,zIndex:r.zIndex}),n.config[a]&&t.addTo(n.map),n.fixZOrder(),n.handleAllLayersAdded()})),c()(this,"handleAllLayersAdded",(function(){n.dataLayers.size===C&&(n.dataLayers.forEach((function(e,t){var o=e.layerGroup;n.layersControl.addOverlay(o,t)})),n.toggleLoadingIndicator(!1))})),c()(this,"fixZOrder",(function(){Array.from(n.dataLayers.values()).sort((function(e,t){return t.zIndex-e.zIndex})).forEach((function(e){var t=e.layerGroup;n.map.hasLayer(t)&&t.bringToFront()}))})),c()(this,"toggleLoadingIndicator",(function(e){e?f.call("show-loading-indicator"):f.call("hide-loading-indicator")})),this.config=t||_,this.init(),this.bindListeners()}return r()(e,[{key:"init",value:function(){var e=this.config,t=e.lat,n=e.lng,o=e.z;this.map=m.map("map",{zoomControl:!1,attributionControl:!1,maxBounds:[[-85.05,-190],[85.05,200]]}),this.map.setView([t,n],o),this.attributionControl=m.control.attribution({prefix:"Data sources by: "}).addAttribution("<a href='https://www.antievictionmap.com/' target='_blank'>Anti-Eviction Mapping Project</a>").addAttribution("<a href='https://www.openstreetmap.org' target='_blank'>Open Street Map Contributors</a>").addTo(this.map),this.zoomControl=m.control.zoom({position:"bottomright"}).addTo(this.map),this.layersControl=m.control.layers(null,null,{position:"topright",collapsed:!1}).addTo(this.map),this.basemapLayer=m.tileLayer("https://a.basemaps.cartocdn.com/rastertiles/light_all/{z}/{x}/{y}@2x.png",{minZoom:1,maxZoom:18}).addTo(this.map)}},{key:"bindListeners",value:function(){var e,t=this,n=this;this.map.on("popupopen",(function(e){document.getElementById("root").classList.add("aemp-popupopen"),I()&&(f.call("title-details-close"),n.map.invalidateSize()),n.map.setView(e.popup._latlng,n.map.getZoom(),{animate:!0})})),this.map.on("popupclose",(function(){document.getElementById("root").classList.remove("aemp-popupopen"),f.call("close-infowindow"),I()&&setTimeout((function(){n.map.invalidateSize()}),100)})),this.map.on("click",(function(){I()&&f.call("title-details-close")})),this.map.on("overlayadd",(function(){t.fixZOrder()})),window.addEventListener("resize",(function(){clearTimeout(e),e=setTimeout(n.handleWindowResize,250)})),f.on("close-infowindow.map",this.handleInfoWindowClose),f.on("fetch-map-data-resolve.map",this.handleAddLayer),f.on("fetch-map-data-reject.map",this.handleLayerError)}}]),e}(),S=function(){function e(){var t=this;i()(this,e),c()(this,"infowindowContainer",document.getElementById("aemp-infowindow-container")),c()(this,"infowindowTemplate",document.getElementById("aemp-infowindow-template").innerHTML),c()(this,"rentStrikeInfowindowTemplate",document.getElementById("aemp-rentstrike-infowindow-template").innerHTML),c()(this,"closeInfoWindow",(function(){document.getElementById("root").classList.remove("aemp-popupopen"),t.infowindowContainer.innerHTML=null})),c()(this,"render",(function(e){var n=e.template,o=e.data;switch(n){case"protections":t.infowindowContainer.innerHTML=p.a.render(t.infowindowTemplate,o);break;case"rentstrikes":t.infowindowContainer.innerHTML=p.a.render(t.rentStrikeInfowindowTemplate,o)}t.infowindowContainer.querySelector(".aemp-infowindow-close").addEventListener("click",(function(){return f.call("close-infowindow")})),document.getElementById("root").classList.add("aemp-popupopen")})),this.bindListeners()}return r()(e,[{key:"bindListeners",value:function(){f.on("render-infowindow",this.render),f.on("close-infowindow.self",this.closeInfoWindow)}}]),e}(),z=function(){function e(){var t=this;i()(this,e),c()(this,"loadingContainer",document.getElementById("loading-container")),c()(this,"show",(function(){t.loadingContainer.hidden=!1})),c()(this,"hide",(function(){t.loadingContainer.hidden=!0})),this.bindListeners()}return r()(e,[{key:"bindListeners",value:function(){f.on("show-loading-indicator",this.show),f.on("hide-loading-indicator",this.hide)}}]),e}(),D=(n("T63A"),n("5s+n"),n("J4zp")),j=n.n(D),x=n("o0o1"),R=n.n(x),P=(n("ls82"),n("yXPU")),A=n.n(P),M=(n("bZMm"),"https://".concat("ampitup",".carto.com/api/v2/sql"));function B(e,t){f.call(e,null,t)}function q(e,t){f.call(e,null,t)}function H(e){return W.apply(this,arguments)}function W(){return(W=A()(R.a.mark((function e(t){var n,o,i=arguments;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=i.length>1&&void 0!==i[1]?i[1]:"geojson",e.next=3,fetch("".concat(M,"?q=").concat(window.encodeURIComponent(t),"&format=").concat(n));case 3:if((o=e.sent)&&o.ok){e.next=6;break}throw Error("Unable to fetch Carto data");case 6:return e.abrupt("return",o.json());case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function J(){return(J=A()(R.a.mark((function e(){return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Object.entries(w).forEach(function(){var e=A()(R.a.mark((function e(t){var n,o,i,a;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=j()(t,2),o=n[0],i=n[1],e.prev=1,e.next=4,H(i.query);case 4:a=e.sent,B("fetch-map-data-resolve",{key:o,layerConfig:i,data:a}),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(1),q("fetch-map-data-reject",e.t0),f.call("hide-loading-indicator");case 12:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}());case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}n("+2oP"),n("rB9j"),n("EnZy");new N(function(e){for(var t=window.location.hash.slice(1).split("&"),n={},o=0;o<t.length;o++){var i=t[o].split("="),a=j()(i,2),r=a[0],s=a[1];n[r]=s}isNaN(n.z)||(e.z=parseInt(n.z)),isNaN(n.lat)||(e.lat=parseFloat(n.lat)),isNaN(n.lng)||(e.lng=parseFloat(n.lng)),void 0!==n.cities&&("true"===n.cities?e.cities=!0:"false"===n.cities&&(e.cities=!1)),void 0!==n.counties&&("true"===n.counties?e.counties=!0:"false"===n.counties&&(e.counties=!1)),void 0!==n.states&&("true"===n.states?e.states=!0:"false"===n.states&&(e.states=!1)),void 0!==n.nations&&("true"===n.nations?e.nations=!0:"false"===n.nations&&(e.nations=!1)),void 0!==n.rentstrike&&("true"===n.rentstrike?e.rentStrikes=!0:"false"===n.rentstrike&&(e.rentStrikes=!1))}(_)),new S,new function e(){var t=this;i()(this,e),c()(this,"titleDetails",document.getElementById("aemp-titlebox").querySelector("details")),c()(this,"bindListeners",(function(){t.titleDetails.addEventListener("toggle",(function(){this.open?document.getElementById("aemp-titlebox").classList.remove("collapsed"):document.getElementById("aemp-titlebox").classList.add("collapsed")})),f.on("title-details-toggle",t.toggleTitleDetails),f.on("title-details-open",t.openTitleDetails),f.on("title-details-close",t.closeTitleDetails)})),c()(this,"closeTitleDetails",(function(){t.titleDetails.open=!1})),c()(this,"openTitleDetails",(function(){t.titleDetails.open=!0})),c()(this,"toggleTitleDetails",(function(){t.titleDetails.open?t.titleDetails.open=!1:t.titleDetails.open=!0})),this.bindListeners()},new z,function(){J.apply(this,arguments)}()}},[["tjUo",1,2]]]);
//# sourceMappingURL=index.bd892545421e4f43de19.js.map