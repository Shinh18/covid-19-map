(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{"sg+I":function(e,t,n){},tjUo:function(e,t,n){"use strict";n.r(t);n("sg+I");function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function c(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,c=e[Symbol.iterator]();!(r=(a=c.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==c.return||c.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return s(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return s(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var u,p=document.querySelector("body").offsetWidth<640,l=document.querySelector("body").offsetWidth>1200,m="https://docs.google.com/spreadsheets/d/".concat("1rCZfNXO3gbl5H3cKhGXKIv3samJ1KC4nLhCwwZqrHvU","/export?format=csv&id=").concat("1rCZfNXO3gbl5H3cKhGXKIv3samJ1KC4nLhCwwZqrHvU"),d="public.emergency_tenant_protections_scored",f=(u="SELECT\n  c.the_geom, c.county, c.state, m.range, m.policy_type, m.policy_summary, m.link, m.range\n  FROM us_county_boundaries c\n  JOIN ".concat(d," m\n  ON ST_Intersects(c.the_geom, m.the_geom)\n  WHERE m.the_geom IS NOT NULL\n  AND m.admin_scale = 'County'\n  OR m.admin_scale = 'City and County'\n  ORDER BY m.range"),"https://ampitup.carto.com/api/v2/sql?q=".concat(u,"&format=geojson")),y=function(){var e="SELECT\n  s.the_geom, s.name, s.admin, s.sr_adm0_a3, m.range, m.iso, m.policy_type, m.policy_summary, m.link\n  FROM public.states_and_provinces_global s\n  INNER JOIN ".concat(d," m\n  ON s.name = m.state\n  AND s.sr_adm0_a3 = m.iso\n  AND m.admin_scale = 'State'\n  ORDER BY m.range");return"https://ampitup.carto.com/api/v2/sql?q=".concat(e,"&format=geojson")}(),g=function(){var e="SELECT\n  municipality, range, policy_type, policy_summary, link, the_geom\n  FROM ".concat(d," \n  WHERE the_geom is not null and admin_scale = 'City'\n  ORDER BY range");return"https://ampitup.carto.com/api/v2/sql?q=".concat(e,"&format=geojson")}(),h=function(){var e="SELECT c.the_geom, c.adm0_a3, c.name_en, m.range,\n  m.policy_type, m.policy_summary, m.link\n  FROM countries c\n  INNER JOIN ".concat(d," m\n  ON c.adm0_a3 = m.iso\n  AND m.admin_scale = 'Country'\n  ORDER BY m.range");return"https://ampitup.carto.com/api/v2/sql?q=".concat(e,"&format=geojson")}(),v=[void 0,"#d9f0a3","#78c679","#238443"],b=[void 0,"#addd8e","#41ab5d","#005a32"],w=["","Few protections in place","Some protections in place","Many protections in place"],O=4;p?O=3:l&&(O=5);var S={lat:40.67,lng:-97.23,z:O,nations:!1,states:!0,cities:!0,counties:!0,rentStrikes:!0};!function(e){var t=e.slice(1).split("&"),n={},r=0;for(;r<t.length;r++){var o=c(t[r].split("="),2),i=o[0],a=o[1];n[i]=a}isNaN(n.z)||(S.z=parseInt(n.z));isNaN(n.lat)||(S.lat=parseFloat(n.lat));isNaN(n.lng)||(S.lng=parseFloat(n.lng));void 0!==n.cities&&("true"===n.cities?S.cities=!0:"false"===n.cities&&(S.cities=!1));void 0!==n.counties&&("true"===n.counties?S.counties=!0:"false"===n.counties&&(S.counties=!1));void 0!==n.states&&("true"===n.states?S.states=!0:"false"===n.states&&(S.states=!1));void 0!==n.nations&&("true"===n.nations?S.nations=!0:"false"===n.nations&&(S.nations=!1));void 0!==n.rentstrike&&("true"===n.rentstrike?S.rentStrikes=!0:"false"===n.rentstrike&&(S.rentStrikes=!1))}(location.hash);var E,_=L.map("map",{zoomControl:!1,attributionControl:!1,maxBounds:[[-85.05,-190],[85.05,200]]}).setView([S.lat,S.lng],S.z),j=document.getElementById("aemp-titlebox").querySelector("details");function k(){p=document.querySelector("body").offsetWidth<640,_.invalidateSize()}j.addEventListener("toggle",(function(){j.open?document.getElementById("aemp-titlebox").classList.remove("collapsed"):document.getElementById("aemp-titlebox").classList.add("collapsed")})),window.closeInfo=function(){_.closePopup(),_.invalidateSize()},_.on("popupopen",(function(e){document.getElementById("root").classList.add("aemp-popupopen"),p&&(j.open&&(j.open?j.removeAttribute("open"):j.setAttribute("open",!0)),_.invalidateSize()),_.setView(e.popup._latlng,_.getZoom(),{animate:!0})})),_.on("popupclose",(function(){document.getElementById("root").classList.remove("aemp-popupopen"),document.getElementById("aemp-infowindow-container").innerHTML="",p&&setTimeout((function(){_.invalidateSize()}),100)})),_.on("click",(function(){p&&(j.open=!1)})),window.addEventListener("resize",(function(){clearTimeout(E),E=setTimeout(k,250)})),L.control.attribution({prefix:"Data sources by: "}).addAttribution("<a href='https://www.antievictionmap.com/' target='_blank'>Anti-Eviction Mapping Project</a>").addAttribution("<a href='https://www.openstreetmap.org' target='_blank'>Open Street Map Contributors</a>").addTo(_),L.control.zoom({position:"bottomright"}).addTo(_);var T=L.control.layers(null,null,{position:"topright",collapsed:!1}).addTo(_),N=document.querySelector(".popup-template").innerHTML,I=document.getElementById("aemp-infowindow-template").innerHTML,C=document.getElementById("aemp-infowindow-template").innerHTML,M=document.querySelector(".rentstrike-popup-template").innerHTML,P=document.getElementById("aemp-rentstrike-infowindow-template").innerHTML;L.tileLayer("https://a.basemaps.cartocdn.com/rastertiles/light_all/{z}/{x}/{y}@2x.png",{minZoom:1,maxZoom:18}).addTo(_),Promise.all([fetch(m).then((function(e){if(!e.ok)throw Error("Unable to fetch rent strike sheet data");return e.text()})),fetch(y).then((function(e){if(!e.ok)throw Error("Unable to fetch states geojson");return e.json()})),fetch(f).then((function(e){if(!e.ok)throw Error("Unable to fetch counties geojson");return e.json()})),fetch(h).then((function(e){if(!e.ok)throw Error("Unable to fetch nations geojson");return e.json()})),fetch(g).then((function(e){if(!e.ok)throw Error("Unable to fetch cities geojson");return e.json()}))]).then((function(e){var t=c(e,5),n=t[0],r=t[1],i=t[2],s=t[3],u=t[4],l={type:"FeatureCollection",features:d3.csvParse(n,d3.autoType).filter((function(e){var t=e.Strike_Status,n=e.Latitude,r=e.Longitude;return null!==t&&null!==r&&null!==n})).map((function(e){var t=e.Strike_Status;return o({status:"Yes / Sí / 是 / Oui"===t||"Yes"===t?"Yes":"Unsure"},a(e,["Strike_Status"]))})).map((function(e,t){var n=e.Longitude,r=e.Latitude;return{type:"Feature",id:t,properties:a(e,["Longitude","Latitude"]),geometry:{type:"Point",coordinates:[n,r]}}}))},m=(B=s,R={style:function(e){return{color:b[e.properties.range]||"#939393",fillColor:v[e.properties.range]||"#939393",fillOpacity:.7,weight:1.5}}},H=L.geoJson(B,R),H.bindPopup((function(e){var t=e.feature.properties.name_en,n=o({},e.feature.properties,{jurisdictionName:t,jurisdictionType:"Country",popupName:t,policyStrength:w[e.feature.properties.range]}),r=Mustache.render(C,n);return document.getElementById("aemp-infowindow-container").innerHTML=r,Mustache.render(N,n)})),_.addLayer(H),H),d=function(e){var t={style:function(e){return{color:b[e.properties.range]||"#939393",fillColor:v[e.properties.range]||"#939393",fillOpacity:.7,weight:1.5}}},n=L.geoJson(e,t);return n.bindPopup((function(e){var t=e.feature.properties,n=t.name,r=t.admin,i=o({},e.feature.properties,{jurisdictionName:"".concat(n).concat(r?", ".concat(r):""),jurisdictionType:"State/Province",popupName:n,policyStrength:w[e.feature.properties.range]}),a=Mustache.render(I,i);return document.getElementById("aemp-infowindow-container").innerHTML=a,Mustache.render(N,i)})),n.addTo(_),n}(r),f=function(e){var t={style:function(e){return{color:b[e.properties.range]||"#939393",fillColor:v[e.properties.range]||"#939393",fillOpacity:.7,weight:1.5}}},n=L.geoJson(e,t);return n.bindPopup((function(e){var t=e.feature.properties,n=t.county,r=t.state,i=o({},e.feature.properties,{jurisdictionName:"".concat(n).concat(r?", ".concat(r):""),jurisdictionType:"County",popupName:"".concat(n).concat(r?", ".concat(r):""),policyStrength:w[e.feature.properties.range]}),a=Mustache.render(I,i);return document.getElementById("aemp-infowindow-container").innerHTML=a,Mustache.render(N,i)})),n.addTo(_),n}(i),y=function(e){var t=L.geoJson(e,{pointToLayer:function(e,t){return L.circleMarker(t,{color:b[e.properties.range]||"#939393",fillColor:v[e.properties.range]||"#939393",fillOpacity:.7,radius:8,weight:1.5})}});return t.bindPopup((function(e){var t=e.feature.properties,n=t.municipality,r=t.state,i=t.Country,a=o({},e.feature.properties,{jurisdictionName:"".concat(n).concat(r?", ".concat(r):"").concat(i?", ".concat(i):""),jurisdictionType:"City",popupName:n,policyStrength:w[e.feature.properties.range]}),c=Mustache.render(I,a);return document.getElementById("aemp-infowindow-container").innerHTML=c,Mustache.render(N,a)})),t.addTo(_),t}(u),g=(h=l,O=new L.Icon({iconUrl:"./assets/mapIcons/rent-strike.svg",iconSize:[40,40],iconAnchor:[20,20],className:"icon-rent-strike"}),E=L.geoJson(h,{pointToLayer:function(e,t){return L.marker(t,{icon:O})}}),k=L.markerClusterGroup({maxClusterRadius:40}).on("clusterclick",(function(){p&&(j.open=!1)})),k.addLayer(E).bindPopup((function(e){var t=Mustache.render(P,e.feature.properties);return document.getElementById("aemp-infowindow-container").innerHTML=t,Mustache.render(M,e.feature.properties)})),_.addLayer(k),k);var h,O,E,k;var B,R,H;T.addOverlay(g,"Rent Strikes").addOverlay(y,"Cities").addOverlay(f,"Counties").addOverlay(d,"States").addOverlay(m,"Nations"),_.on("overlayadd",(function(){[y,f,d,m].forEach((function(e){_.hasLayer(e)&&e.bringToBack()}))})),S.nations||_.removeLayer(m);S.states||_.removeLayer(d);S.counties||_.removeLayer(f);S.cities||_.removeLayer(y);S.rentStrikes||_.removeLayer(g)})).catch((function(e){return console.log(e)}))}},[["tjUo",1]]]);
//# sourceMappingURL=index.15b72e8ee56f7101948c.js.map